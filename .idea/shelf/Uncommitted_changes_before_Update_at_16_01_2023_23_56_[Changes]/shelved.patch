Index: app/src/main/java/com/example/easyway/LoginActivity.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.easyway\r\n\r\nimport android.content.Intent\r\nimport androidx.appcompat.app.AppCompatActivity\r\nimport android.os.Bundle\r\nimport android.widget.Button\r\nimport android.widget.EditText\r\nimport android.widget.Toast\r\nimport com.example.easyway.Models.Login\r\nimport com.example.easyway.Models.User\r\nimport com.example.easyway.Services.LoginService\r\nimport com.example.easyway.Services.MealService\r\nimport com.example.easyway.Services.TicketService\r\nimport com.google.gson.JsonParser\r\nimport retrofit2.Call\r\n\r\nimport retrofit2.Callback\r\nimport retrofit2.Response\r\nimport retrofit2.Retrofit\r\nimport retrofit2.converter.gson.GsonConverterFactory\r\n\r\nclass LoginActivity : AppCompatActivity() {\r\n\r\n    // Declaração de variáveis\r\n\r\n    // Retrofit\r\n\r\n    val baseURL = \"http://10.0.2.2:5000/\"\r\n    var retrofit = Retrofit.Builder().baseUrl(baseURL).addConverterFactory(GsonConverterFactory.create()).build()\r\n\r\n    val mealService = retrofit.create(MealService::class.java)\r\n    val ticketService = retrofit.create(TicketService::class.java)\r\n    val loginService = retrofit.create(LoginService::class.java)\r\n\r\n    val email: EditText by lazy {\r\n        findViewById<EditText>(R.id.main_email_et)\r\n    }\r\n\r\n    val password: EditText by lazy {\r\n        findViewById<EditText>(R.id.main_password_et)\r\n    }\r\n\r\n    val button: Button by lazy {\r\n        findViewById<Button>(R.id.main_login_btn)\r\n    }\r\n\r\n\r\n    override fun onCreate(savedInstanceState: Bundle?) {\r\n        super.onCreate(savedInstanceState)\r\n        setContentView(R.layout.activity_main)\r\n\r\n\r\n        button.setOnClickListener{\r\n            login(email.text.toString(),password.text.toString())\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n       // button.setOnClickListener(this)\r\n    }\r\n\r\n    fun login(email:String,password:String){\r\n        val log = loginService.Login(Login(email,password))\r\n\r\n        log.enqueue(object :Callback<List<User>>{\r\n            override fun onResponse(call: Call<List<User>>, response: Response<List<User>>) {\r\n                if(response.code() == 200){\r\n                    val logged = response.body()\r\n                    println(logged)\r\n                    val user = logged?.get(0)?.user\r\n                    val jsonParser = JsonParser()\r\n                    val jsonObject = jsonParser.parse(user)\r\n                    val newUser = jsonObject.asJsonArray.get(0).asJsonObject\r\n\r\n                    // Utilização de SharedPreferences\r\n                    val sharedPref = getSharedPreferences(\"preferences\", MODE_PRIVATE)\r\n                    val editor = sharedPref.edit()\r\n                    editor.apply()\r\n                    {\r\n                        var name = newUser.get(\"name\").toString()\r\n                        name = name.substring(1,name.length-1)\r\n                        var email = newUser.get(\"email\").toString()\r\n                        email = email.substring(1,email.length-1)\r\n                        var idNumber = newUser.get(\"idNumber\").toString()\r\n                        idNumber = idNumber.substring(1,idNumber.length-1)\r\n                        var pid = newUser.get(\"pid\").toString()\r\n                        putString(\"name\",name)\r\n                        putString(\"email\",email)\r\n                        putString(\"idNumber\",idNumber)\r\n                        putString(\"pid\",pid)\r\n                        apply()\r\n                    }\r\n\r\n                    val intent = Intent(this@LoginActivity,DashboardActivity::class.java)\r\n\r\n                    startActivity(intent)\r\n                }\r\n                else{\r\n                    Toast.makeText(this@LoginActivity,\"Incorrect Credentials\",Toast.LENGTH_LONG).show()\r\n                }\r\n            }\r\n            override fun onFailure(call: Call<List<User>>, t: Throwable) {\r\n                Toast.makeText(this@LoginActivity,\"Incorrect Credentials\",Toast.LENGTH_LONG).show()\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/easyway/LoginActivity.kt b/app/src/main/java/com/example/easyway/LoginActivity.kt
--- a/app/src/main/java/com/example/easyway/LoginActivity.kt	
+++ b/app/src/main/java/com/example/easyway/LoginActivity.kt	
@@ -59,7 +59,6 @@
 
 
 
-
        // button.setOnClickListener(this)
     }
 
